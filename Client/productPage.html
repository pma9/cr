<!doctype html>
<html>
  <head>
    <title>MktMake Client</title>
    <link rel="stylesheet" type="text/css" href="product.css">
    <style>
      table, th, td{
        color:white;
        background-color: black;
        border: 1px solid gray;
        border-collapse: collapse;
      }
    </style>
    <script src='/socket.io/socket.io.js'></script>
    <script>
      var socket = io();
      socket.on('orderInit',function(bids){
        for(var i = 0;i<bids.length;i++){
          addOrder('bid',bids[i]);
        }
      });
      socket.on('bidOrderUpdate',function(index,order){
        var num = Number(index) + 1;
        updateOrder('bid',num,order);
      });
      socket.on('bidFill',function(fill){
        addFill('bidFills',fill);
      });
      function update(id,data){
         var element = document.getElementById(id);
         var num = Number(data).toFixed(2);
         element.innerHTML = num;
      }
      function updateTime(id){
         var element = document.getElementById(id);
         var time = new Date().toISOString();
         element.innerHTML = time;
      }
      function addOrder(tableID,order){
        table = document.getElementById(tableID);
        var row = table.insertRow(table.rows.length);
        var cell0 = row.insertCell(0);
        var cell1 = row.insertCell(1);
        var cell2 = row.insertCell(2);
        var cell3 = row.insertCell(3);
        cell0.innerHTML = table.rows.length -2;
        cell1.innerHTML = order.state;
        var price = Number(order.price).toFixed(2);
        cell2.innerHTML = price;
        cell3.innerHTML = order.size;
      }
      function updateOrder(tableID,index,order){
        table = document.getElementById(tableID);
        table.rows[index].cells[0].innerHTML = index;
        table.rows[index].cells[1].innerHTML = order.state;
        var price = Number(order.price).toFixed(2);
        table.rows[index].cells[2].innerHTML = price;
        table.rows[index].cells[3].innerHTML = order.size;
      }
      function addFill(tableId,fill){
        table = document.getElementById(tableID);
        var row = table.insertRow(table.rows.length);
        var cell0 = row.insertCell(0);
        var cell1 = row.insertCell(1);
        var cell2 = row.insertCell(2);
        var cell3 = row.insertCell(3);
        var cell4 = row.insertCell(4);
        cell0.innerHTML = fill.trade_id;
        var price = Number(fill.price).toFixed(2);
        cell1.innerHTML = fill.side
        cell2.innerHTML = price;
        cell3.innerHTML = fill.size;
        cell4.innerHTML = fill.time;
      }
    </script>
  </head>
  <body bgcolor = black>
  <div id="container">
    <div id="working_div">
      <h4>working</h4> 
      <table style="font-size:12pt;" id="bid">
        <tr>
          <th>Bid</th>
          <th>State</th>
          <th>Price</th>
          <th>Size</th>
          <th>Ask</th>
          <th>State</th>
          <th>Price</th>
          <th>Size</th>
        </tr>
      </table>
    </div>
    <div id="divider_div"></div>
    <div id="fills_div">
      <h4>fills</h4>
      <table style="font-size:12pt;" id="bidFills">
        <tr>
          <th>Bid</th>
          <th>Side</th>
          <th>Price</th>
          <th>Size</th>
          <th>Time</th>
        </tr>
      </table>
    </div>
  </div>
  </body>
</html>
